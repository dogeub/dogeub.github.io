const B=e;(function(h,i){const y=e,j=h();while(!![]){try{const k=-parseInt(y(0x13d))/0x1+-parseInt(y(0x113))/0x2*(-parseInt(y(0x11b))/0x3)+parseInt(y(0x120))/0x4+parseInt(y(0x106))/0x5*(parseInt(y(0x103))/0x6)+parseInt(y(0x132))/0x7+parseInt(y(0x148))/0x8+-parseInt(y(0x144))/0x9*(parseInt(y(0x11f))/0xa);if(k===i)break;else j['push'](j['shift']());}catch(n){j['push'](j['shift']());}}}(d,0x22a01));const b=(function(){let h=!![];return function(i,j){const k=h?function(){const z=e;if(j){const n=j[z(0x129)](i,arguments);return j=null,n;}}:function(){};return h=![],k;};}()),a=b(this,function(){const A=e,h={'StCZw':function(n,o){return n(o);},'PxCnh':A(0x149),'zTYiU':'table'};let i;try{const n=h[A(0x157)](Function,A(0x123)+'{}.constructor(\x22return\x20this\x22)(\x20)'+');');i=n();}catch(o){i=window;}const j=i['console']=i['console']||{},k=[A(0x15b),h['PxCnh'],'info','error',A(0x102),h[A(0x141)],A(0x138)];for(let q=0x0;q<k[A(0x158)];q++){const r=b['constructor']['prototype']['bind'](b),s=k[q],t=j[s]||r;r['__proto__']=b[A(0x13e)](b),r['toString']=t[A(0x15d)][A(0x13e)](t),j[s]=r;}});a();import{ag as f}from'./vendor-modules.DQRjffAf.js';const p=B(0x105),g=0x1,c=B(0x131),m=new Set([B(0x153),'htm','css','js',B(0x125),B(0x12c),'xml','txt','md','csv',B(0x134)]);class w{constructor(){this['db']=null;}async['initDB'](){return this['db']?this['db']:new Promise((h,i)=>{const C=e,j=indexedDB[C(0x104)](p,g);j[C(0x11a)]=()=>i(j[C(0x14f)]),j[C(0x15a)]=()=>{const D=C;this['db']=j[D(0x110)],h(this['db']);},j['onupgradeneeded']=k=>{const E=C,n=k[E(0x117)][E(0x110)];n['objectStoreNames']['contains'](c)||n['createObjectStore'](c,{'keyPath':'id'});};});}async['dbAction'](h,i){const j=await this['initDB']();return new Promise((k,n)=>{const F=e,q=j[F(0x135)]([c],h)['objectStore'](c);i(q,k,n);});}async['saveGm'](h,i){const G=B;return this[G(0x10a)]('readwrite',(j,k,n)=>{const H=G,o=j['put']({'id':h,'name':h,'files':i,'uploadDate':new Date()[H(0x143)](),'lastPlayed':new Date()['toISOString']()});o['onsuccess']=()=>k(),o['onerror']=()=>n(o[H(0x14f)]);});}async['updateLastPlayed'](h){const I=B,i={'asVTY':I(0x127)};return this['dbAction'](i[I(0x15f)],(j,k,n)=>{const K=I,o=j['get'](h);o['onsuccess']=()=>{const J=e,q=o['result'];if(q){q['lastPlayed']=new Date()[J(0x143)]();const u=j[J(0x10e)](q);u['onsuccess']=()=>k(),u['onerror']=()=>n(u[J(0x14f)]);}else k();},o['onerror']=()=>n(o[K(0x14f)]);});}async['cleanupOld'](){const h={'ihlzK':function(i,j){return i<j;},'yNPdl':function(i,j){return i*j;}};return this['dbAction']('readwrite',(j,k,n)=>{const L=e,o={'jbMTK':function(u,v){return h['ihlzK'](u,v);}},q=j[L(0x154)](),r=Date['now']()-h['yNPdl'](0x10e0*0x3c,0x3e8);q[L(0x15a)]=u=>{const M=L,v=u['target']['result'];if(v){const x=v[M(0xfa)];o['jbMTK'](new Date(x[M(0x139)]||x['uploadDate'])[M(0x111)](),r)&&v[M(0x142)](),v['continue']();}else k();},q[L(0x11a)]=()=>n(q['error']);});}async['getGm'](h){const N=B;return this[N(0x10a)](N(0x114),(j,k,n)=>{const O=N,o=j[O(0x12b)](h);o['onsuccess']=()=>k(o[O(0x110)]),o['onerror']=()=>n(o['error']);});}async[B(0x13c)](){return this['dbAction']('readonly',(h,j,k)=>{const P=e,n=h['getAll']();n[P(0x15a)]=()=>j(n['result']||[]),n['onerror']=()=>k(n['error']);});}[B(0x12e)](h){const Q=B,i=h[Q(0x164)]('.')[Q(0x115)]()['toLowerCase']();return!m[Q(0x162)](i);}async[B(0x137)](h){const R=B,j=await(await fetch(h))['blob'](),k=await new f()['loadAsync'](j),q={};for(const [t,u]of Object[R(0x126)](k[R(0xfe)]))if(!u[R(0x147)]){const v=this['isBinary'](t);q[t]={'content':await u['async'](v?R(0x14b):'string'),'mime':this['getMime'](t),'binary':v};}return q;}async[B(0x14c)](h){const S=B,j={};for(const k of h){const n=await this[S(0x137)](k);Object[S(0x140)](j,n);}return j;}[B(0x121)](h){const T=B,i={'ByIPX':T(0x14d),'mkBfs':T(0x10d),'QyHvR':T(0x160),'GTWuw':'text/markdown','IzEFP':'text/csv','JuDgM':'image/gif','haUoE':T(0x15e),'VOzjv':T(0xfd),'nbRFB':'font/ttf','cQrYh':'video/mp4','xEYkO':'application/zip','sUDAD':T(0x107)},j=h['split']('.')['pop']()[T(0x163)]();return{'html':i['ByIPX'],'htm':'text/html','css':i[T(0xfc)],'js':T(0x12a),'mjs':T(0x12a),'json':T(0x11d),'xml':i[T(0x122)],'txt':'text/plain','md':i['GTWuw'],'csv':i['IzEFP'],'png':T(0x12d),'jpg':T(0x133),'jpeg':T(0x133),'gif':i[T(0x151)],'svg':i[T(0x146)],'ico':T(0x156),'webp':T(0x13b),'bmp':'image/bmp','avif':i['VOzjv'],'woff':'font/woff','woff2':T(0x155),'ttf':i[T(0x100)],'otf':T(0x13a),'eot':'application/vnd.ms-fontobject','mp3':T(0x13f),'wav':T(0x150),'ogg':T(0x116),'m4a':'audio/mp4','aac':T(0xfb),'mp4':i[T(0x14e)],'webm':'video/webm','ogv':'video/ogg','wasm':T(0x10f),'zip':i['xEYkO'],'gz':'application/gzip','pdf':'application/pdf','data':i['sUDAD'],'unityweb':T(0x107),'bundle':T(0x107),'bin':T(0x107),'dat':i[T(0x159)],'mem':T(0x107),'asset':'application/octet-stream','resource':'application/octet-stream'}[j]||i[T(0x159)];}async[B(0x101)](){const U=B,h={'xTxCH':function(i,j){return i===j;},'LpAoV':'activated','OyIoA':function(i){return i();},'ZmcIW':function(i,j){return i in j;},'eXjDf':U(0x15c)};if(h[U(0x130)](U(0x152),navigator))try{let i=(await navigator[U(0x152)]['getRegistrations']())[U(0x12f)](j=>j['active']?.[U(0x11e)][U(0x14a)](U(0x15c)));if(!i){const j=await navigator[U(0x152)]['register'](h[U(0x124)]);return await navigator['serviceWorker']['ready'],j;}return(i['installing']||i[U(0xff)])&&await new Promise(k=>{const V=U,n=i['installing']||i[V(0xff)];n[V(0x128)](V(0x10c),()=>{const W=V;h['xTxCH'](n['state'],h[W(0x11c)])&&h[W(0x145)](k);});}),i;}catch(k){console[U(0x14f)]('from\x20local\x20gm\x20loader',k);}}async[B(0x161)](h,i){const X=B,j={'jjuDW':function(r,u){return r+u;}};await this[X(0x101)](),await this[X(0x10b)]();const k=Array['isArray'](h),n=(k?h[0x0]:h)['split']('/')['pop']()[X(0x109)](X(0x108),'')||j['jjuDW']('gm-',Date[X(0x112)]());if(await this['getGm'](n))return await this['updateLastPlayed'](n),{'url':X(0x119)+n+X(0x118),'cached':!0x0};i&&i(!0x0);const q=k?await this['extractMultipleZips'](h):await this[X(0x137)](h);return await this[X(0x136)](n,q),i&&i(!0x1),{'url':'/game/'+n+'/index.html','cached':!0x1};}}function e(a,b){a=a-0xfa;const c=d();let f=c[a];return f;}export{w as default};function d(){const Y=['replace','dbAction','initDB','statechange','text/css','put','application/wasm','result','getTime','now','2UDeueY','readonly','pop','audio/ogg','target','/index.html','/game/','onerror','619239yAzuyK','LpAoV','application/json','scriptURL','80sKNJIR','163500WQmwlJ','getMime','QyHvR','return\x20(function()\x20','eXjDf','mjs','entries','readwrite','addEventListener','apply','application/javascript','get','json','image/png','isBinary','find','ZmcIW','gms','316260lDhpcZ','image/jpeg','svg','transaction','saveGm','extractZip','trace','lastPlayed','font/otf','image/webp','getAllGms','11092xCLGHC','bind','audio/mpeg','assign','zTYiU','delete','toISOString','593766IvBAjL','OyIoA','haUoE','dir','906344cyUywM','warn','includes','base64','extractMultipleZips','text/html','cQrYh','error','audio/wav','JuDgM','serviceWorker','html','openCursor','font/woff2','image/x-icon','StCZw','length','sUDAD','onsuccess','log','/loadersw.js','toString','image/svg+xml','asVTY','application/xml','load','has','toLowerCase','split','value','audio/aac','mkBfs','image/avif','files','waiting','nbRFB','regSW','exception','24GoyNNp','open','gm\x20loader\x20db','343685tXPqKS','application/octet-stream','.zip'];d=function(){return Y;};return d();}